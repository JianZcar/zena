- gschema:
    id: org.gnome.shell
    filename: zz0-00-extensions.gschema.override
    settings:
      enabled-extensions:
        - appindicatorsupport@rgcjonas.gmail.com
        - gsconnect@andyholmes.github.io
        - just-perfection-desktop@just-perfection
        - blur-my-shell@aunetx
        - hotedge@jonathan.jdoda.ca
        - caffeine@patapon.info
        - restartto@tiagoporsch.github.io
        - ideapad@laurento.frittella 
        - light-style@gnome-shell-extensions.gcampax.github.com
      disabled-extensions:
        - user-theme@gnome-shell-extensions.gcampax.github.com

- gschema:
    id: org.gnome.software
    filename: zz0-01-third-party.gschema.override
    settings:
      allow-third-party: true

- gschema:
    id: org.gnome.desktop.peripherals.mouse
    filename: zz0-02-mouse.gschema.override
    settings:
      accel-profile: 'flat'

- gschema:
    id: org.gnome.Ptyxis
    filename: zz0-03-ptyxis.gschema.override
    settings:
      interface-style: 'system'

- gschema:
    id: org.gnome.shell.extensions.blur-my-shell.panel
    filename: zz0-04-blurmyshellpanel.gschema.override
    settings:
      force-light-text: true

- path: /etc/flatpak/remotes.d/flathub.flatpakrepo
  content: |
    [Flatpak Remote]
    Name=flathub
    Title=Flathub
    Url=https://flathub.org/repo/flathub.flatpakrepo
    IsDefault=true

# Allow writing conservation_mode without sudo password
- path: /etc/sudoers.d/ideapad 
  content: |
    %wheel ALL=(ALL) NOPASSWD: /usr/bin/tee /sys/bus/platform/drivers/ideapad_acpi/VPC2004\:00/conservation_mode

- path: /etc/modules
  content: |
    ideapad_laptop

- path: /etc/zena/zena-first-boot.sh
  permissions: '0755'
  content: |
    #!/bin/bash

    FLAG_FILE="/var/lib/zena-done"

    if [ ! -f "$FLAG_FILE" ]; then
      /usr/bin/fedora-third-party enable
      rpm-ostree rebase ostree-unverified-registry:ghcr.io/jianzcar/zena:latest
      touch /var/lib/zena-done
    fi

- path: /etc/systemd/system/zena-first-boot.service
  content: |
    [Unit]
    Description=Zena First Boot Setup
    After=multi-user.target

    [Service]
    Type=oneshot
    ExecStart=/etc/zena/zena-first-boot.sh
    RemainAfterExit=true

    [Install]
    WantedBy=multi-user.target
